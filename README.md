# Семантический поиск

## Описание

Этот проект реализует семантический поиск, который анализирует смысл и контекст запроса пользователя, а не просто точное совпадение слов. Семантический поиск позволяет находить релевантные документы даже тогда, когда в них не встречаются те же ключевые слова, что и в запросе.

## Особенности

- Понимание смысла и контекста запроса
- Использование предобученных моделей трансформеров для получения эмбеддингов
- Поддержка нескольких языков (русский и английский)
- Возможность сохранения и загрузки обученной модели
- Высокая точность за счет косинусного сходства эмбеддингов

## Архитектура решения

### 1. Обработка текста
- Приведение к нижнему регистру
- Удаление пунктуации
- Лемматизация слов
- Удаление стоп-слов

### 2. Генерация эмбеддингов
- Использование предобученной модели `SentenceTransformer`
- Преобразование текстов в векторы высокой размерности
- Сохранение семантической информации в числовом виде

### 3. Поиск по сходству
- Вычисление косинусного сходства между запросом и документами
- Ранжирование результатов по степени релевантности
- Возврат топ-K наиболее релевантных документов

## Как использовать

### Базовый пример

```python
from advanced_semantic_search import AdvancedSemanticSearchEngine

# Создание экземпляра поискового движка
search_engine = AdvancedSemanticSearchEngine()

# Добавление документов
documents = [
    "Искусственный интеллект - это область компьютерных наук...",
    "Машинное обучение - это подраздел искусственного интеллекта..."
]
search_engine.add_documents(documents)

# Поиск по запросу
results = search_engine.search("Как работает ИИ?", top_k=3)

for idx, score in results:
    print(f"Релевантность: {score:.3f}")
    print(f"Документ: {search_engine.documents[idx]}")
```

### Сохранение и загрузка модели

```python
# Сохранение
search_engine.save_model("my_search_model.pkl")

# Загрузка
search_engine.load_model("my_search_model.pkl")
```

## Различие между точным и семантическим поиском

| Тип поиска | Описание | Пример |
|------------|----------|--------|
| Точный поиск | Ищет документы с совпадающими словами | Запрос: "автомобиль" → найдет только документы со словом "автомобиль" |
| Семантический поиск | Понимает смысл и контекст запроса | Запрос: "машина" → найдет документы с "автомобиль", "транспорт", "транспортное средство" и т.д. |

## Требования

- Python 3.7+
- sentence-transformers
- scikit-learn
- nltk
- torch
- numpy

## Установка зависимостей

```bash
pip install sentence-transformers scikit-learn nltk torch numpy
```

## Примеры использования

Проект содержит два уровня реализации:

1. **Базовый семантический поиск** (`semantic_search_app.py`): использует TF-IDF и косинусное сходство
2. **Расширенный семантический поиск** (`advanced_semantic_search.py`): использует предобученные трансформерные модели

## Примеры запросов и ожидаемых результатов

- Запрос: "Как компьютеры понимают человеческую речь?" → Найдет документ о "обработке естественного языка"
- Запрос: "Программирование на Python" → Найдет документ о "языке программирования Python"
- Запрос: "Хранение информации" → Найдет документ о "базах данных"

## Преимущества семантического поиска

1. **Понимание смысла**: Находит релевантные документы даже без точного совпадения слов
2. **Контекстуальное понимание**: Учитывает семантические связи между словами и фразами
3. **Масштабируемость**: Может работать с большими коллекциями документов
4. **Многоязычность**: Поддерживает несколько языков с помощью мультилингвальных моделей